<!DOCTYPE html>
<html class="dark" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Media Gallery - Filigran Duo</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Noto+Sans:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#1754cf",
              "background-light": "#f6f6f8",
              "background-dark": "#111318",
            },
            fontFamily: {
              "display": ["Noto Serif", "serif"],
              "sans": ["Noto Sans", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.5rem", "lg": "0.75rem", "xl": "1rem", "full": "9999px"},
          },
        },
      }
    </script>
<style>
      .material-symbols-outlined {
        font-variation-settings:
        'FILL' 0,
        'wght' 400,
        'GRAD' 0,
        'opsz' 24
      }
    </style>
    </head>
    <body class="font-sans bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200" style="background-color:#0c0a09 !important;">
<div class="relative flex min-h-screen w-full flex-col group/design-root overflow-x-hidden">

<div id="navigation-placeholder"></div>

</br>
</br>

<main class="flex flex-1 flex-col">
<div class="w-full bg-gray-100 dark:bg-gray-900/50 pt-16 pb-12">
<div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex flex-col gap-3">
<h1 class="font-display text-gray-900 dark:text-white text-4xl sm:text-5xl font-black leading-tight tracking-[-0.033em]">Media Gallery</h1>
<p class="text-gray-500 dark:text-[#9da6b8] text-base sm:text-lg font-normal leading-normal max-w-2xl">A curated collection of our performances and moments.</p>
</div>
</div>
</div>
<div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
<div class="flex flex-col gap-8">
<div class="flex">
<div class="flex h-10 w-full sm:w-auto items-center justify-center rounded-lg bg-gray-200 dark:bg-[#292e38] p-1">
<label class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-lg px-4 has-[:checked]:bg-white dark:has-[:checked]:bg-background-dark has-[:checked]:shadow-[0_0_4px_rgba(0,0,0,0.1)] has-[:checked]:text-gray-900 dark:has-[:checked]:text-white text-gray-500 dark:text-[#9da6b8] text-sm font-medium leading-normal transition-colors">
<span class="truncate">All</span>
<input checked="" class="invisible w-0" name="media-filter" type="radio" value="All"/>
</label>
<label class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-lg px-4 has-[:checked]:bg-white dark:has-[:checked]:bg-background-dark has-[:checked]:shadow-[0_0_4px_rgba(0,0,0,0.1)] has-[:checked]:text-gray-900 dark:has-[:checked]:text-white text-gray-500 dark:text-[#9da6b8] text-sm font-medium leading-normal transition-colors">
<span class="truncate">Photos</span>
<input class="invisible w-0" name="media-filter" type="radio" value="Photos"/>
</label>
<label class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-lg px-4 has-[:checked]:bg-white dark:has-[:checked]:bg-background-dark has-[:checked]:shadow-[0_0_4px_rgba(0,0,0,0.1)] has-[:checked]:text-gray-900 dark:has-[:checked]:text-white text-gray-500 dark:text-[#9da6b8] text-sm font-medium leading-normal transition-colors">
<span class="truncate">Videos</span>
<input class="invisible w-0" name="media-filter" type="radio" value="Videos"/>
</label>
</div>
</div>
<div id="gallery-grid" class="grid grid-cols-[repeat(auto-fill,minmax(250px,1fr))] gap-6"></div>

</div>
<script>
  (function(){
    const grid = document.getElementById('gallery-grid');

    function extractYouTubeId(url) {
      if (!url) return null;
      const match = url.match(
        /(?:youtube\.com\/.*[?&]v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/
      );
      return match ? match[1] : null;
    }

    function youtubeThumb(url) {
      const id = extractYouTubeId(url);
      return id ? `https://img.youtube.com/vi/${id}/hqdefault.jpg` : null;
    }

    function renderList(manifest, filter){
      grid.innerHTML = '';

      const photos = (manifest.photos || []).map(p => ({
        type: 'photo',
        src: p,
        bg: p
      }));

      const videos = (manifest.videos || []).map(v => {
        const thumb = youtubeThumb(v);
        return thumb ? {
          type: 'video',
          src: v,
          bg: thumb
        } : null;
      }).filter(Boolean);

      const all = photos.concat(videos);

      const items = all.filter(m =>
        filter === 'All' ||
        (filter === 'Photos' && m.type === 'photo') ||
        (filter === 'Videos' && m.type === 'video')
      );

      if(items.length === 0){
        grid.innerHTML = '<p class="text-gray-500">No media to display.</p>';
        return;
      }

      for(const m of items){
        const div = document.createElement('div');
        div.className = `
          group relative bg-cover bg-center flex flex-col
          gap-3 rounded-lg justify-end p-4
          aspect-[3/4] overflow-hidden cursor-pointer
        `;
        div.style.backgroundImage = `url("${m.bg}")`;

        const overlay = document.createElement('div');
        overlay.className = 'absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors';
        div.appendChild(overlay);

        // Play icon for videos
        if (m.type === 'video') {
          const icon = document.createElement('div');
          icon.className = `
            absolute inset-0 flex items-center justify-center
            text-white text-6xl opacity-80 group-hover:opacity-100
            transition-opacity z-10
          `;
          icon.innerHTML = 'â–¶';
          div.appendChild(icon);
        }

        div.addEventListener('click', () => {
          if (m.type === 'photo') {
            window.open(m.src, '_blank');
          } else {
            window.open(m.src, '_blank');
          }
        });

        grid.appendChild(div);
      }
    }

    function loadAndRender(filter){
      fetch('/data/gallery.json')
        .then(r => r.json())
        .then(manifest => renderList(manifest, filter))
        .catch(err => {
          console.error('Failed to load gallery manifest:', err);
          grid.innerHTML = '<p class="text-red-500">Failed to load gallery.</p>';
        });
    }

    document.querySelectorAll('input[name="media-filter"]').forEach(r => {
      r.addEventListener('change', e => loadAndRender(e.target.value));
    });

    // initial render
    loadAndRender('All');
  })();
</script>
</div>
</div>
</main>

<div id="footer-placeholder"></div>

</div>

<script>
  fetch("/components/navigation.html")
      .then(response => response.text())
      .then(data => {
        document.getElementById("navigation-placeholder").innerHTML = data;
        initNavigation();
      })
      .catch(err => console.error("Navigation load error:", err));

  fetch("/components/footer.html")
      .then(response => response.text())
      .then(data => {
        document.getElementById("footer-placeholder").innerHTML = data;
      })
      .catch(err => console.error("Footer load error:", err));
</script>

<script src="/components/navigation.js"></script>

</body></html>