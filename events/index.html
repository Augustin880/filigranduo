<!DOCTYPE html>
<html class="dark" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Events</title>

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"/>

<script>
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        primary: "#1754cf",
        "background-light": "#f6f6f8",
        "background-dark": "#111318",
      },
      fontFamily: {
        display: ["Noto Serif", "serif"],
        sans: ["Noto Sans", "sans-serif"],
      },
    },
  },
}
</script>

<style>
body { font-family: 'Noto Sans', sans-serif; }
h1,h2,h3,h4,h5,h6 { font-family: 'Noto Serif', serif; }

/* HERO */
#events-hero {
  background-image:
    linear-gradient(0deg, rgba(0,0,0,.4) 0%, rgba(0,0,0,0) 25%),
    url("/img/media3.png");
  background-size: cover;
  background-position: center;
}
@media (max-width: 767px) {
  #events-hero {
    background-image:
      linear-gradient(0deg, rgba(0,0,0,.4) 0%, rgba(0,0,0,0) 25%),
      url("/img/media3b.png");
  }
}

/* ===== EVENT LIST ===== */

.event-list-1{
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

/* FIXED STRUCTURE CARD */
.event-item-1{
  display: grid;
  grid-template-columns: 1fr 180px;
  grid-template-rows: auto auto;
  align-items: center;

  padding: 1.4rem 1.8rem;
  border-radius: 8px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  backdrop-filter: blur(8px);

  transition: background 0.3s, transform 0.3s;
}

.event-item-1:hover{
  background: rgba(255,255,255,0.12);
  transform: translateY(-2px);
}

/* TITLE — FULL TEXT VISIBLE */
.event-title-1{
  grid-column: 1 / 2;
  grid-row: 1 / 2;

  font-size: 1.15rem;
  line-height: 1.35;
  color: #fff;

  white-space: normal;
  word-break: break-word;
}

/* DATE */
.event-date-1{
  grid-column: 1 / 2;
  grid-row: 2 / 3;

  font-size: 0.9rem;
  color: #aaa;
  white-space: nowrap;
}

/* BUTTON — FIXED SIZE */
.btn-ticket-1{
  grid-column: 2 / 3;
  grid-row: 1 / span 2;
  justify-self: end;

  width: 160px;
  height: 40px;

  border: 1px solid rgba(255,255,255,0.6);
  background: transparent;
  color: #fff;

  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;

  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;

  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-ticket-1:hover{
  background: #fff;
  color: #000;
}

/* ===== PAST EVENT ===== */

.event-item-1.event-past{
  opacity: 0.55;
  pointer-events: none;
}

.event-status{
  margin-left: 0.6rem;
  padding: 0.15rem 0.5rem;
  font-size: 0.65rem;
  letter-spacing: 0.08em;
  border-radius: 999px;
  background: rgba(255,255,255,0.15);
  color: #bbb;
  text-transform: uppercase;
}

.btn-disabled{
  border-color: rgba(255,255,255,0.25);
  color: #aaa;
}

/* MOBILE — SAME FOR UPCOMING & PAST */
@media(max-width:700px){
  .event-item-1{
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
    align-items: start;
  }

  .event-title-1{
    grid-column: 1 / 2;
    grid-row: 1 / 2;
  }

  .event-date-1{
    grid-column: 1 / 2;
    grid-row: 2 / 3;
  }

  .btn-ticket-1{
    grid-column: 1 / 2;
    grid-row: 3 / 4;
    justify-self: start;
    margin-top: 0.75rem;
  }
}

</style>
</head>

<body class="bg-background-light dark:bg-background-dark" style="background-color:#0c0a09 !important;">

<div class="relative min-h-screen flex flex-col overflow-x-hidden">

<div id="navigation-placeholder"></div>

<main class="flex-1">

  <!-- HERO -->
  <div id="events-hero" class="flex justify-end flex-col min-h-[520px]">
    <div class="px-4 sm:px-8 md:px-20 lg:px-40 py-6">
      <p class="text-white text-4xl sm:text-5xl md:text-6xl font-bold font-display">
        Performances
      </p>
    </div>
  </div>

  <!-- CONTENT -->
  <div class="px-4 sm:px-8 md:px-20 lg:px-40 py-10 flex justify-center">
    <div class="max-w-[960px] w-full">

      <!-- TOGGLE (UNCHANGED) -->
      <div class="flex px-4 py-3 mb-6">
        <div class="flex h-10 w-full rounded-lg bg-[#e0e0e0] dark:bg-[#292e38] p-1">
          <label class="flex-1 flex items-center justify-center cursor-pointer rounded-lg
            has-[:checked]:bg-background-light dark:has-[:checked]:bg-background-dark
            has-[:checked]:shadow text-sm font-medium text-[#6b7280] dark:text-[#9da6b8]">
            <span>Upcoming Events</span>
            <input checked class="hidden" type="radio" name="event_toggle" value="upcoming">
          </label>
          <label class="flex-1 flex items-center justify-center cursor-pointer rounded-lg
            has-[:checked]:bg-background-light dark:has-[:checked]:bg-background-dark
            has-[:checked]:shadow text-sm font-medium text-[#6b7280] dark:text-[#9da6b8]">
            <span>Past Events</span>
            <input class="hidden" type="radio" name="event_toggle" value="past">
          </label>
        </div>
      </div>

      <!-- EVENTS -->
      <div id="events-list" class="event-list-1"></div>

    </div>
  </div>

</main>

<div id="footer-placeholder"></div>
</div>

<script>
  fetch("/components/navigation.html")
      .then(response => response.text())
      .then(data => {
        document.getElementById("navigation-placeholder").innerHTML = data;
        initNavigation();
      })
      .catch(err => console.error("Navigation load error:", err));

  fetch("/components/footer.html")
      .then(response => response.text())
      .then(data => {
        document.getElementById("footer-placeholder").innerHTML = data;
      })
      .catch(err => console.error("Footer load error:", err));
</script>

<script src="/components/navigation.js"></script>

<script>
(function(){
  const esc = s => String(s||"").replace(/[&<>'"]/g,c=>(
    {"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;","\"":"&quot;"}[c]
  ));

  const parseDate = s => {
    const m = String(s).match(/(\d{1,2})\s+([A-Za-z]+)\s+(\d{4})/);
    return m ? new Date(`${m[2]} ${m[1]} ${m[3]}`) : null;
  };

  async function load(){
    const res = await fetch("/data/performances.json",{cache:"no-cache"});
    const data = await res.json();
    const list = data.performances || [];

    const today = new Date(); today.setHours(0,0,0,0);

    const enriched = list.map(p=>({...p, d:parseDate(p.date)}));
    const upcoming = enriched.filter(p=>!p.d || p.d>=today);
    const past = enriched.filter(p=>p.d && p.d<today).reverse();

    const container = document.getElementById("events-list");

    function render(items, isPast){
      container.innerHTML = "";
      if(!items.length){
        container.innerHTML =
          `<p class="text-center text-gray-400">No events.</p>`;
        return;
      }

      items.forEach(perf=>{
        const el = document.createElement("div");
        el.className = `event-item-1${isPast ? " event-past" : ""}`;

        el.innerHTML = `
          <div class="event-title-1">${esc(perf.title)}</div>
          <div class="event-date-1">
            ${esc(perf.date)}
            ${isPast ? `<span class="event-status">Past</span>` : ``}
          </div>
          ${
            isPast
              ? `<button class="btn-ticket-1 btn-disabled">Past performance</button>`
              : `<a href="${esc(perf.link||"#")}"
                  target="_blank"
                  class="btn-ticket-1">
                  Get Tickets
                </a>`
          }
        `;
        container.appendChild(el);
      });
    }

    document.querySelectorAll('input[name="event_toggle"]')
      .forEach(r => r.addEventListener("change", e => {
        render(
          e.target.value === "past" ? past : upcoming,
          e.target.value === "past"
        );
      }));

    render(upcoming,false);
  }

  load();
})();
</script>

</body>
</html>
