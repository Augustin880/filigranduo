<!DOCTYPE html>
<html class="dark" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Events</title>

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"/>

<script>
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        primary: "#1754cf",
        "background-light": "#f6f6f8",
        "background-dark": "#111318",
      },
      fontFamily: {
        display: ["Noto Serif", "serif"],
        sans: ["Noto Sans", "sans-serif"],
      },
    },
  },
}
</script>

<style>
body { font-family: 'Noto Sans', sans-serif; }
h1,h2,h3,h4,h5,h6 { font-family: 'Noto Serif', serif; }

#events-hero {
  background-image:
    linear-gradient(0deg, rgba(0,0,0,.4) 0%, rgba(0,0,0,0) 25%),
    url("/img/media3.png");
  background-size: cover;
  background-position: center;
}
@media (max-width: 767px) {
  #events-hero {
    background-image:
      linear-gradient(0deg, rgba(0,0,0,.4) 0%, rgba(0,0,0,0) 25%),
      url("/img/media3b.png");
  }
}
</style>
</head>

<body class="bg-background-light dark:bg-background-dark">

<div class="relative min-h-screen flex flex-col overflow-x-hidden">

<div id="navigation-placeholder"></div>

<main class="flex-1">

  <!-- HERO -->
  <div id="events-hero" class="flex justify-end flex-col min-h-[520px]">
    <div class="px-4 sm:px-8 md:px-20 lg:px-40 py-6">
      <p class="text-white text-4xl sm:text-5xl md:text-6xl font-bold font-display">
        Performances
      </p>
    </div>
  </div>

  <!-- CONTENT -->
  <div class="px-4 sm:px-8 md:px-20 lg:px-40 py-10 flex justify-center">
    <div class="max-w-[960px] w-full">

      <!-- TOGGLE -->
      <div class="flex px-4 py-3 mb-6">
        <div class="flex h-10 w-full rounded-lg bg-[#e0e0e0] dark:bg-[#292e38] p-1">
          <label class="flex-1 flex items-center justify-center cursor-pointer rounded-lg
            has-[:checked]:bg-background-light dark:has-[:checked]:bg-background-dark
            has-[:checked]:shadow text-sm font-medium text-[#6b7280] dark:text-[#9da6b8]">
            <span>Upcoming Events</span>
            <input checked class="hidden" type="radio" name="event_toggle" value="upcoming">
          </label>
          <label class="flex-1 flex items-center justify-center cursor-pointer rounded-lg
            has-[:checked]:bg-background-light dark:has-[:checked]:bg-background-dark
            has-[:checked]:shadow text-sm font-medium text-[#6b7280] dark:text-[#9da6b8]">
            <span>Past Events</span>
            <input class="hidden" type="radio" name="event_toggle" value="past">
          </label>
        </div>
      </div>

      <!-- EVENTS -->
      <div id="events-list" class="flex flex-col gap-6"></div>

    </div>
  </div>

</main>

<div id="footer-placeholder"></div>
</div>

<script>
fetch("/components/navigation.html")
  .then(r => r.text())
  .then(t => document.getElementById("navigation-placeholder").innerHTML = t);

fetch("/components/footer.html")
  .then(r => r.text())
  .then(t => document.getElementById("footer-placeholder").innerHTML = t);
</script>

<script>
(function(){
  const esc = s => String(s||"").replace(/[&<>'"]/g,c=>(
    {"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;","\"":"&quot;"}[c]
  ));

  const parseDate = s => {
    const m = String(s).match(/(\d{1,2})\s+([A-Za-z]+)\s+(\d{4})/);
    return m ? new Date(`${m[2]} ${m[1]} ${m[3]}`) : null;
  };

  async function load(){
    const res = await fetch("/data/performances.json",{cache:"no-cache"});
    const data = await res.json();
    const list = data.performances || [];

    const today = new Date(); today.setHours(0,0,0,0);

    const enriched = list.map(e=>({...e, d:parseDate(e.date)}));
    const upcoming = enriched.filter(e=>!e.d || e.d>=today);
    const past = enriched.filter(e=>e.d && e.d<today).reverse();

    const container = document.getElementById("events-list");

    function render(items, isPast){
      if(!items.length){
        container.innerHTML =
          `<p class="text-center text-gray-400">No events.</p>`;
        return;
      }

      container.innerHTML = items.map(p=>`
<div class="bg-white dark:bg-[#1C1F26] rounded-xl shadow-md p-6 ${isPast?'opacity-60':''}">
  <div class="flex flex-col md:flex-row gap-6">

    <!-- TEXT COLUMN -->
    <div class="flex-1 flex flex-col justify-between gap-4">

      <div class="flex flex-col gap-3">

        <!-- DATE + STATUS -->
        <div class="flex items-center gap-3">
          <p class="text-sm text-[#6b7280] dark:text-[#9da6b8]">${esc(p.date)}</p>
          ${isPast ? `
          <span class="text-xs uppercase tracking-wide px-2 py-1 rounded-full
                       bg-[#e0e0e0] dark:bg-[#292e38]
                       text-[#6b7280] dark:text-[#9da6b8]">
            Past
          </span>` : ``}
        </div>

        <!-- TITLE -->
        <p class="text-lg font-bold font-display text-black dark:text-white">
          ${esc(p.title)}
        </p>

        <!-- VENUE -->
        ${p.venue ? `
        <p class="text-sm font-medium text-black dark:text-white">
          ${esc(p.venue)}
        </p>` : ``}

        <!-- DESCRIPTION -->
        ${p.description ? `
        <p class="text-sm text-[#6b7280] dark:text-[#9da6b8]">
          ${esc(p.description)}
        </p>` : ``}

      </div>

      <!-- ACTION -->
      ${isPast ? `
      <div class="w-fit h-8 px-4 flex items-center justify-center rounded-lg
                  bg-[#e0e0e0] dark:bg-[#292e38]
                  text-sm text-[#6b7280] dark:text-[#9da6b8]">
        Past performance
      </div>
      ` : `
      <a href="${esc(p.link||"#")}" target="_blank"
         class="w-fit h-8 px-4 flex items-center justify-center rounded-lg
                bg-[#e0e0e0] dark:bg-[#292e38]
                hover:bg-[#d1d1d1] dark:hover:bg-[#3a404d]
                text-sm font-medium transition">
        Details
      </a>`}

    </div>

    <!-- IMAGE -->
    ${p.image ? `
    <div class="hidden md:block w-[320px] aspect-video rounded-lg bg-cover bg-center"
         style="background-image:url('${esc(p.image)}')"></div>` : ``}

  </div>
</div>`).join("");
    }

    document.querySelectorAll('input[name="event_toggle"]')
      .forEach(r => r.addEventListener("change", e => {
        render(
          e.target.value === "past" ? past : upcoming,
          e.target.value === "past"
        );
      }));

    render(upcoming,false);
  }

  load();
})();
</script>

</body>
</html>
